<?xml version="1.0" encoding="utf-8"?>
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:data="using:VirtualPaper.UIComponent.Data"
    xmlns:container="using:VirtualPaper.UIComponent.Container"
    xmlns:local="using:VirtualPaper.UIComponent.Utils">
    <!--  Other app resources here  -->
    <ResourceDictionary.ThemeDictionaries>
        <ResourceDictionary x:Key="Default">
            <AcrylicBrush
             x:Key="AcrylicInAppCustomGridBrush"
             FallbackColor="{ThemeResource SystemAltMediumColor}"
             TintColor="#2C2C2C"
             TintOpacity="0.15" />
            <AcrylicBrush
             x:Key="AcrylicBackgroundCustomBrush"
             FallbackColor="{ThemeResource SystemAltMediumColor}"
             TintColor="{ThemeResource SystemAltMediumColor}"
             TintLuminosityOpacity="0.5"
             TintOpacity="0.5" />
        </ResourceDictionary>

        <ResourceDictionary x:Key="HighContrast">
            <SolidColorBrush x:Key="AcrylicInAppCustomGridBrush" Color="{ThemeResource SystemColorWindowColor}" />
            <SolidColorBrush x:Key="AcrylicBackgroundCustomBrush" Color="{ThemeResource SystemColorWindowColor}" />
        </ResourceDictionary>

        <ResourceDictionary x:Key="Light">
            <AcrylicBrush
             x:Key="AcrylicInAppCustomGridBrush"
             FallbackColor="{ThemeResource SystemAltMediumColor}"
             TintColor="#FCFCFC"
             TintOpacity="0.5" />
            <AcrylicBrush
             x:Key="AcrylicBackgroundCustomBrush"
             FallbackColor="{ThemeResource SystemAltMediumColor}"
             TintColor="{ThemeResource SystemAltMediumColor}"
             TintLuminosityOpacity="0.5"
             TintOpacity="0.2" />
        </ResourceDictionary>
    </ResourceDictionary.ThemeDictionaries>
  
    <Style TargetType="container:SelectableItemsControl">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="container:SelectableItemsControl">
                    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
                        <VisualStateManager.VisualStateGroups>
                            <!-- Visual states can be defined here -->
                        </VisualStateManager.VisualStateGroups>

                        <!-- 内联定义 TabContainer 样式 -->
                        <Grid 
                            x:Name="RootGrid"
                            Background="Transparent">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="DragOver">
                                        <VisualState.Setters>
                                            <Setter Target="ControlForegroundBorder.Visibility" Value="Visible"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <!-- 选项卡标题行 -->
                            <ItemsPresenter 
                                x:Name="TabHeader"/>

                            <!-- 内容显示区域 -->
                            <Frame 
                                x:Name="ContentFrame" 
                                Grid.Row="1"
                                Content="{Binding Content}"/>

                            <Border
                                x:Name="ControlForegroundBorder"
                                Grid.RowSpan="2"
                                Background="#e47ee4"
                                Opacity="0.3"
                                Visibility="Collapsed"/>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <!-- 定义 ItemContainerStyle -->
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="container:CustomContainer">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="container:CustomContainer">
                                <Grid
                                    Margin="2" 
                                    Height="30" 
                                    Background="{ThemeResource LayerFillColorAltBrush}">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal"/>
                                            <VisualState x:Name="PointerOver">
                                                <VisualState.Setters>
                                                    <Setter Target="ContainerForegroundBorder.Opacity" Value="0"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState x:Name="Selected">
                                                <VisualState.Setters>
                                                    <Setter Target="ContainerForegroundBorder.Opacity" Value="0"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>

                                    <Border 
                                        x:Name="ContainerForegroundBorder"
                                        Background="{ThemeResource ControlStrongStrokeColorDisabledBrush}"
                                        Opacity="0.5"/>

                                    <Grid 
                                        Padding="4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition MinWidth="20"/>
                                            <ColumnDefinition Width="auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock 
                                            VerticalAlignment="Center" 
                                            Text="{Binding Header}"/>

                                        <Button 
                                            Grid.Column="2" 
                                            Padding="0" 
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Click="Button_Click">
                                            <FontIcon
                                                FontSize="12" 
                                                FontFamily="Segoe MDL2 Assets" 
                                                Glyph="&#xE711;"/>
                                        </Button>
                                    </Grid>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>

        <!-- ItemsPanelTemplate -->
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <data:AutoSizeWrap />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>

        <!-- ItemTemplate -->
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <ContentPresenter DataContext="{Binding}"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
