<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="VirtualPaper.UI.Views.WpSettingsComponents.LibraryContents"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:VirtualPaper.UI.Views.WpSettingsComponents"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vms="using:VirtualPaper.UI.ViewModels.WpSettingsComponents"
    xmlns:models="using:VirtualPaper.Models.WallpaperMetaData"
    xmlns:utils="using:VirtualPaper.UI.Utils"
    mc:Ignorable="d"
    x:Name="Page"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <ItemsView 
            x:Name="ItemsView"            
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            HorizontalContentAlignment="Left"
            VerticalContentAlignment="Center"
            ItemsSource="{Binding LibraryWallpapers}"
            SelectionMode="Extended"
            IsItemInvokedEnabled="True"
            RightTapped="ItemsView_RightTapped"            
            ItemInvoked="ItemsView_ItemInvoked">
            <ItemsView.ItemTemplate>
                <DataTemplate>
                    <ItemContainer 
                        AutomationProperties.Name="{Binding Title}">
                        <Grid>
                            <Image 
                                Height="200"
                                Width="300"
                                Source="{Binding ThumbnailPath}"
                                Stretch="UniformToFill" 
                                HorizontalAlignment="Center" 
                                VerticalAlignment="Center"
                                ImageFailed="Image_ImageFailed"/>
                            <StackPanel 
                                Orientation="Vertical" 
                                Height="60" 
                                VerticalAlignment="Bottom" 
                                Padding="5,1"  
                                Background="{ThemeResource SystemControlBackgroundBaseMediumBrush}" 
                                Opacity=".75">
                                <TextBlock 
                                    Text="{Binding Title}" 
                                    FontSize="20"
                                    TextWrapping="Wrap"
                                    HorizontalTextAlignment="Left"
                                    Foreground="{ThemeResource SystemControlForegroundAltHighBrush}"/>
                            </StackPanel>
                        </Grid>
                    </ItemContainer>
                </DataTemplate>
            </ItemsView.ItemTemplate>
            <ItemsView.Layout>
                <UniformGridLayout 
                    MinRowSpacing="5" 
                    MinColumnSpacing="5" 
                    MaximumRowsOrColumns="5"/>
            </ItemsView.Layout>
            <ItemsView.ContextFlyout>
                <MenuFlyout
                    x:Name="ItemsViewMenu">
                    <MenuFlyoutItem
                        x:Name="DetailedInfo"
                        Text="{Binding MenuFlyout_Text_DetailedInfo}"
                        Click="ContextMenu_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE946;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem
                        x:Name="EditInfo"
                        Text="{Binding MenuFlyout_Text_EditInfo}"
                        Click="ContextMenu_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE70F;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem 
                        x:Name="Preview"                         
                        Text="{Binding MenuFlyout_Text_Preview}"
                        Click="ContextMenu_Click" >
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8A1;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem 
                        x:Name="Import" 
                        Text="{Binding MenuFlyout_Text_Import}"
                        Click="ContextMenu_Click" >
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8B5;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem 
                        x:Name="Apply" 
                        Text="{Binding MenuFlyout_Text_Apply}"
                        Click="ContextMenu_Click" >
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE8FB;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem
                         x:Name="ShowOnDisk"
                         Text="{Binding MenuFlyout_Text_ShowOnDisk}"
                         Click="ContextMenu_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xED25;" />
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                    <MenuFlyoutItem
                        x:Name="Delete"
                        Text="{Binding MenuFlyout_Text_Delete}"
                        Click="ContextMenu_Click">
                        <MenuFlyoutItem.Icon>
                            <FontIcon Glyph="&#xE74D;" 
                                      Foreground="Goldenrod"/>
                        </MenuFlyoutItem.Icon>
                    </MenuFlyoutItem>
                </MenuFlyout>
            </ItemsView.ContextFlyout>
        </ItemsView>

        <StackPanel
            Orientation="Vertical"
            VerticalAlignment="Center"
            HorizontalAlignment="Center">
            <ProgressRing 
                VerticalAlignment="Center"
                HorizontalAlignment="Center"
                IsActive="True"
                Visibility="{Binding LoadingVisibility}"
                Height="80"
                Width="80"
                Margin="50 20"
                Background="Transparent"/>

            <TextBlock
                Margin="50 20"
                Visibility="{Binding LoadingVisibility}"
                VerticalAlignment="Center"
                HorizontalAlignment="Center"
                FontSize="18"
                Text="{Binding Text_Loading}"/>
        </StackPanel>
    </Grid>
</Page>
